// ============================================================================
// REPORTING FEATURE MODULE
// Enable with: features.reporting = true
// ============================================================================

model Report {
  id         String           @id @default(cuid())
  category   ReportCategory
  status     ReportStatus     @default(pending)
  entityType String           @map("entity_type")
  entityId   String           @map("entity_id")
  reporterId String           @map("reporter_id")
  reason     String?
  details    Json?            @db.JsonB
  weight     Float            @default(1.0)
  createdAt  DateTime         @default(now()) @map("created_at")
  resolvedAt DateTime?        @map("resolved_at")
  resolverId String?          @map("resolver_id")

  reporter User  @relation("ReportedBy", fields: [reporterId], references: [id], onDelete: Cascade)
  resolver User? @relation("ResolvedBy", fields: [resolverId], references: [id], onDelete: SetNull)

  @@unique([reporterId, entityType, entityId, status], name: "unique_active_report")
  @@index([entityType, entityId, status])
  @@index([category, status])
  @@index([reporterId])
  @@index([createdAt])
  @@map("reports")
}

// ============================================================================
// REPORTING ENUMS
// ============================================================================

enum ReportCategory {
  // Safety & Harm (high priority - apply to all entity types)
  under_18_content
  harassment_or_bullying
  suicide_self_harm
  violent_or_disturbing

  // Content Quality (apply to content entities)
  spam
  misinformation
  unwanted_content

  // Legal/Policy (apply to all entity types)
  illegal_content

  // User-specific categories
  impersonation_or_fake
  spam_account
}

enum ReportStatus {
  pending
  aggregated
  queued
  resolved
  dismissed
}
